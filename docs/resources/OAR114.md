There are mandatory response headers and others that are not allowed. Overriding certain headers or allowing any headers to be set and not specifying required headers can cause vulnerabilities in the API.

This rule enforces the presence of mandatory response headers and restricts the use of response headers to a predefined allowed list.

### Mandatory Response Headers

The following response headers are mandatory:

- `x-api-key`
- `x-trace-id`


### Allowed Response Headers

Only the following response headers are allowed:

- `x-api-key`
- `traceId`
- `dateTime`

Any other response header is considered noncompliant.



Noncompliant Code Example (OpenAPI 2)
-------------------------------------

In this example, a forbidden response header is defined and mandatory headers are missing.

``` yaml
swagger: "2.0"
info:
  version: 1.0.0
  title: Swagger Petstore
paths:
  /pets:
    get:
      responses:
        200: # Noncompliant {{OAR114: OAR114: Missing mandatory response x-api-key and x-trace-id headers, or forbidden headers are present.}}
          description: Ok
          headers:
            Authorization: # Noncompliant
              description: Forbidden header
              schema:
                type: string
```

Compliant Solution (OpenAPI 2)
------------------------------

Only allowed response headers are defined and all mandatory headers are present.

``` yaml
swagger: "2.0"
info:
  version: 1.0.0
  title: Swagger Petstore
paths:
  /pets:
    get:
      responses:
        200:
          description: Ok
          headers:
            x-api-key:
              description: Mandatory header
              schema:
                type: string
            x-trace-id:
              description: Mandatory header
              schema:
                type: string
            traceId:
              description: Optional but allowed
              schema:
                type: string
```

Noncompliant Code Example (OpenAPI 3)
-------------------------------------

In this example, a forbidden response header is defined and mandatory headers are missing.

``` yaml
openapi: "3.0.0"
info:
  version: 1.0.0
  title: Swagger Petstore
paths:
  /pets:
    get:
      responses:
        200: # Noncompliant {{OAR114: OAR114: Missing mandatory response x-api-key and x-trace-id headers, or forbidden headers are present.}}
          description: Ok
          headers:
            Authorization: # Noncompliant
              description: Forbidden header
              schema:
                type: string
```

Compliant Solution (OpenAPI 3)
------------------------------

Only allowed response headers are defined and all mandatory headers are present.

``` yaml
openapi: "3.0.0"
info:
  version: 1.0.0
  title: Swagger Petstore
paths:
  /pets:
    get:
      responses:
        200:
          description: Ok
          headers:
            x-api-key:
              description: Mandatory header
              schema:
                type: string
            x-trace-id:
              description: Mandatory header
              schema:
                type: string
            traceId:
              description: Optional but allowed
              schema:
                type: string
```